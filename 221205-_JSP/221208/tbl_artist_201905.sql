CREATE TABLE TBL_ARTIST_201905 (
    ARTIST_ID CHAR(4) NOT NULL PRIMARY KEY,
    ARTIST_NAME VARCHAR2(20),
    ARTIST_GENDER CHAR(1),
    ARTIST_BIRTH CHAR(8),
    TALENT CHAR(1),
    AGENCY VARCHAR2(20)
);

INSERT INTO TBL_ARTIST_201905 (
    ARTIST_ID,
    ARTIST_NAME,
    ARTIST_GENDER,
    ARTIST_BIRTH,
    TALENT,
    AGENCY
) VALUES (
    'A001',
    '김스타',
    'F',
    '19970101',
    '1',
    'A엔터테인먼트'
);

INSERT INTO TBL_ARTIST_201905 (
    ARTIST_ID,
    ARTIST_NAME,
    ARTIST_GENDER,
    ARTIST_BIRTH,
    TALENT,
    AGENCY
) VALUES (
    'A002',
    '조스타',
    'M',
    '19980201',
    '2',
    'B엔터테인먼트'
);

INSERT INTO TBL_ARTIST_201905 (
    ARTIST_ID,
    ARTIST_NAME,
    ARTIST_GENDER,
    ARTIST_BIRTH,
    TALENT,
    AGENCY
) VALUES (
    'A003',
    '왕스타',
    'M',
    '19990301',
    '3',
    'C엔터테인먼트'
);

INSERT INTO TBL_ARTIST_201905 (
    ARTIST_ID,
    ARTIST_NAME,
    ARTIST_GENDER,
    ARTIST_BIRTH,
    TALENT,
    AGENCY
) VALUES (
    'A004',
    '정스타',
    'M',
    '20000401',
    '1',
    'D엔터테인먼트'
);

INSERT INTO TBL_ARTIST_201905 (
    ARTIST_ID,
    ARTIST_NAME,
    ARTIST_GENDER,
    ARTIST_BIRTH,
    TALENT,
    AGENCY
) VALUES (
    'A005',
    '홍스타',
    'F',
    '20010501',
    '2',
    'E엔터테인먼트'
);

SELECT
    *
FROM
    TBL_ARTIST_201905
ORDER BY
    ARTIST_ID;

COMMIT;

CREATE TABLE TBL_MEMTO_201905 (
    MENTO_ID CHAR(4) NOT NULL PRIMARY KEY,
    MENTO_NAME VARCHAR2(20)
);

INSERT INTO TBL_MEMTO_201905 (
    MENTO_ID,
    MENTO_NAME
) VALUES (
    'J001',
    '함멘토'
);

INSERT INTO TBL_MEMTO_201905 (
    MENTO_ID,
    MENTO_NAME
) VALUES (
    'J002',
    '박멘토'
);

INSERT INTO TBL_MEMTO_201905 (
    MENTO_ID,
    MENTO_NAME
) VALUES (
    'J003',
    '장멘토'
);

SELECT
    *
FROM
    TBL_MEMTO_201905;

COMMIT;

CREATE TABLE TBL_POINT_201905 (
    SERIAL_NO NUMBER(8) NOT NULL,
    ARTIST_ID CHAR(4),
    MENTO_ID CHAR(4),
    POINT NUMBER(3),
    CONSTRAINT POINT_FK1 FOREIGN KEY (ARTIST_ID) REFERENCES TBL_ARTIST_201905(ARTIST_ID),
    CONSTRAINT POINT_FK2 FOREIGN KEY (MENTO_ID) REFERENCES TBL_MEMTO_201905(MENTO_ID),
    CONSTRAINT POINT_PK PRIMARY KEY (SERIAL_NO)
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019001',
    'A001',
    'J001',
    78
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019002',
    'A001',
    'J002',
    76
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019003',
    'A001',
    'J003',
    70
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019004',
    'A002',
    'J001',
    80
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019005',
    'A002',
    'J002',
    72
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019006',
    'A002',
    'J003',
    78
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019007',
    'A003',
    'J001',
    90
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019008',
    'A003',
    'J002',
    92
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019009',
    'A003',
    'J003',
    88
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019010',
    'A004',
    'J001',
    96
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019011',
    'A004',
    'J002',
    90
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019012',
    'A004',
    'J003',
    98
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019013',
    'A005',
    'J001',
    88
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019014',
    'A005',
    'J002',
    86
);

INSERT INTO TBL_POINT_201905 (
    SERIAL_NO,
    ARTIST_ID,
    MENTO_ID,
    POINT
) VALUES (
    '2019015',
    'A005',
    'J003',
    88
);

SELECT
    *
FROM
    TBL_POINT_201905;

COMMIT;

SELECT
    A.SERIAL_NO,
    A.ARTIST_ID,
    B.ARTIST_NAME,
    B.ARTIST_BIRTH,
    A.POINT,
    C.MENTO_NAME
FROM
    TBL_POINT_201905  A
    INNER JOIN TBL_ARTIST_201905 B
    ON A.ARTIST_ID = B.ARTIST_ID
    INNER JOIN TBL_MEMTO_201905 C
    ON A.MENTO_ID = C.MENTO_ID
GROUP BY
    A.SERIAL_NO,
    A.ARTIST_ID,
    B.ARTIST_NAME,
    B.ARTIST_BIRTH,
    A.POINT,
    C.MENTO_NAME;

SELECT
    B.ARTIST_ID,
    B.ARTIST_NAME,
    B.ARTIST_GENDER,
    SUM(A.POINT) AS TOT,
    ROUND(SUM(A.POINT) / COUNT(C.MENTO_ID),
    2)           AS AVG
FROM
    TBL_POINT_201905  A
    INNER JOIN TBL_ARTIST_201905 B
    ON A.ARTIST_ID = B.ARTIST_ID
    INNER JOIN TBL_MEMTO_201905 C
    ON A.MENTO_ID = C.MENTO_ID
GROUP BY
    B.ARTIST_ID,
    B.ARTIST_NAME,
    B.ARTIST_GENDER
ORDER BY
    AVG DESC;